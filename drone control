

import vrep


import time
import keyboard 
import numpy as np

a = np.ones(3, dtype = float)
print ('Program started')
vrep.simxFinish(-1) # just in case, close all opened connections
clientID=vrep.simxStart('127.0.0.1',19999,True,True,5000,5) # Connect to V-REP
if clientID!=-1:
    print ('Connected to remote API server')

    # Now try to retrieve data in a blocking fashion (i.e. a service call):
    res,objs=vrep.simxGetObjects(clientID,vrep.sim_handle_all,vrep.simx_opmode_blocking)
    if res==vrep.simx_return_ok:
        print ('Number of objects in the scene: ',len(objs))
    else:
        print ('Remote API function call returned with error code: ',res)

    time.sleep(2)
    number,objecthandle=vrep.simxGetObjectHandle(clientID,'Quadricopter_target', vrep.simx_opmode_blocking)
    
    # Now retrieve streaming data (i.e. in a non-blocking fashion):
    startTime=time.time()
    #vrep.simxGetIntegerParameter(clientID,vrep.sim_intparam_mouse_x,vrep.simx_opmode_streaming) # Initialize streaming
    while True:
       # used try so that if user pressed other than the given key error will not be shown
      if keyboard.is_pressed('q'): 
       a[0]=0
       a[1]=0.1
       a[2]=0   
       vrep.simxSetObjectPosition(clientID,objecthandle,vrep.sim_handle_parent,a,vrep.simx_opmode_oneshot)
       print('w')
      if keyboard.is_pressed('s'): 
       a[0]=0
       a[1]=-0.1
       a[2]=0   
       vrep.simxSetObjectPosition(clientID,objecthandle,vrep.sim_handle_parent,a,vrep.simx_opmode_oneshot)
       print('s')
      if keyboard.is_pressed('a'): 
       a[0]=0.1
       a[1]=0
       a[2]=0   
       vrep.simxSetObjectPosition(clientID,objecthandle,vrep.sim_handle_parent,a,vrep.simx_opmode_oneshot)
       print('a')
      if keyboard.is_pressed('d'): 
       a[0]=-0.1
       a[1]=0
       a[2]=0  
       vrep.simxSetObjectPosition(clientID,objecthandle,vrep.sim_handle_parent,a,vrep.simx_opmode_oneshot)
       print('d')
      if keyboard.is_pressed('w'): 
       break;
     
          #break  # if user pressed a key other than the given key the loop will break

    
    vrep.simxAddStatusbarMessage(clientID,'Hello V-REP!',vrep.simx_opmode_oneshot)
    vrep.simxGetPingTime(clientID)
    vrep.simxFinish(clientID)
else:
    print ('Failed connecting to remote API server')
print ('Program ended')
